# Editing guidelines: https://github.com/watch-devtube/contrib/#how-to-edit-video-metadata

tags:
    - web
    - react
    - security
title: '#HITB2018AMS D2T1 - Sandbox Evasion Using VBA Referencing - Aviv Grafi & Amit Dori'
recordingDate: 1524904653
description: "The sandbox, last line of defense for many networks, isn’t what it used to be. In our talk, we show how attackers can bypass sandbox security, inserting malicious code on servers without getting flagged, by taking advantage of basic rules of how VBA (Visual Basic for Applications) macros and sandboxes operate. If once a sandbox could “arrest” a VBA macro based on its anomalous structure or attempted activity, the method we demonstrate shows how attackers can hide their capabilities and change their actions to evade detection by sandboxes.\n\nThe trick is in taking advantage of VBA’s support of referencing methods from another remote VBA project, and principles of sandbox security, which let files do whatever they were programmed to do without impediment or limitation, in a supervised environment. In our presentation, we demonstrate how malicious actors might take advantage of these principles to carry out attacks:\n\n    An attacker prepares two documents. One document, containing macros that trigger malicious actions, is placed on\n    the attacker’s server.A second document, sent to the victim, contains a macro that simply calls functions from the malicious document.\n    If that document is executed within a sandbox, the attacker is alerted that a sandbox environment is present, and the macro is being served an “innocent” function, or an empty one. When the document passes through the sandbox onto the user’s machine, the attacker is informed that it’s operating in a user environment, and unleashes the malicious macro.\n    The attacker can pull this off without having to use any sandbox-evasion capabilities.\n\nHow does the attacker guarantees shipping a benign file for sandbox environments and a malicious file for a user environment without applying any sandbox evasion tricks? How do commercial sandboxes react to this technique? All this and more will be answered in this presentation.\n\n=== \n\nAviv is a tinkerer, a tailor, a (former) soldier – though he’s never been a spy – who heads R&D and innovation at Votiro, an Israeli start-up that seeks to make the world safer for enterprise and ordinary users with advanced cyber-security technology. A graduate of the Israeli Army’s elite 8200 intelligence unit, Aviv has accumulated over 15 years of experience in the fields of telecommunications, embedded technologies, and information security.\n\nAviv holds a B.sc in computer science, a BA in economics, and an MBA from Tel Aviv University. He is the inventor and principal software architect of Votiro’s enterprise protection solutions. He is also a big fan of sushi, running, and quiet walks along the beach.\n\n--- \n\nAmit is a 27 year old security enthusiast, has been for the past 10 years, based in Tel Aviv. Topics that he is most interested in include cryptocurrencies, application hacking, along with general security. Amit has a BSC in Computer Science alongside a BA in Psychology. Currently working as a security researcher at Votiro, and formerly worked as malware analyst (focusing on exploit-kits) at Check Point. He plays the guitar, swims often and (used to) skateboard."
